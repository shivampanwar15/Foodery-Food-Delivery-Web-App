{"ast":null,"code":"\"use strict\";\n\n// Copyright 2022 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nvar _possibleConstructorReturn = require(\"/Users/shivampanwar/Desktop/GoFood/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/possibleConstructorReturn\");\nvar _getPrototypeOf = require(\"/Users/shivampanwar/Desktop/GoFood/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\nvar _inherits = require(\"/Users/shivampanwar/Desktop/GoFood/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\nvar _assertThisInitialized = require(\"/Users/shivampanwar/Desktop/GoFood/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/assertThisInitialized\");\nvar _wrapNativeSuper = require(\"/Users/shivampanwar/Desktop/GoFood/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/wrapNativeSuper\");\nvar _classCallCheck = require(\"/Users/shivampanwar/Desktop/GoFood/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\nvar _createClass = require(\"/Users/shivampanwar/Desktop/GoFood/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.InvalidSubjectTokenError = exports.InvalidMessageFieldError = exports.InvalidCodeFieldError = exports.InvalidTokenTypeFieldError = exports.InvalidExpirationTimeFieldError = exports.InvalidSuccessFieldError = exports.InvalidVersionFieldError = exports.ExecutableResponseError = exports.ExecutableResponse = void 0;\nvar SAML_SUBJECT_TOKEN_TYPE = 'urn:ietf:params:oauth:token-type:saml2';\nvar OIDC_SUBJECT_TOKEN_TYPE1 = 'urn:ietf:params:oauth:token-type:id_token';\nvar OIDC_SUBJECT_TOKEN_TYPE2 = 'urn:ietf:params:oauth:token-type:jwt';\n/**\n * Defines the response of a 3rd party executable run by the pluggable auth client.\n */\nvar ExecutableResponse = /*#__PURE__*/function () {\n  /**\n   * Instantiates an ExecutableResponse instance using the provided JSON object\n   * from the output of the executable.\n   * @param responseJson Response from a 3rd party executable, loaded from a\n   * run of the executable or a cached output file.\n   */\n  function ExecutableResponse(responseJson) {\n    _classCallCheck(this, ExecutableResponse);\n    // Check that the required fields exist in the json response.\n    if (!responseJson.version) {\n      throw new InvalidVersionFieldError(\"Executable response must contain a 'version' field.\");\n    }\n    if (responseJson.success === undefined) {\n      throw new InvalidSuccessFieldError(\"Executable response must contain a 'success' field.\");\n    }\n    this.version = responseJson.version;\n    this.success = responseJson.success;\n    // Validate required fields for a successful response.\n    if (this.success) {\n      this.expirationTime = responseJson.expiration_time;\n      this.tokenType = responseJson.token_type;\n      // Validate token type field.\n      if (this.tokenType !== SAML_SUBJECT_TOKEN_TYPE && this.tokenType !== OIDC_SUBJECT_TOKEN_TYPE1 && this.tokenType !== OIDC_SUBJECT_TOKEN_TYPE2) {\n        throw new InvalidTokenTypeFieldError(\"Executable response must contain a 'token_type' field when successful \" + \"and it must be one of \".concat(OIDC_SUBJECT_TOKEN_TYPE1, \", \").concat(OIDC_SUBJECT_TOKEN_TYPE2, \", or \").concat(SAML_SUBJECT_TOKEN_TYPE, \".\"));\n      }\n      // Validate subject token.\n      if (this.tokenType === SAML_SUBJECT_TOKEN_TYPE) {\n        if (!responseJson.saml_response) {\n          throw new InvalidSubjectTokenError(\"Executable response must contain a 'saml_response' field when token_type=\".concat(SAML_SUBJECT_TOKEN_TYPE, \".\"));\n        }\n        this.subjectToken = responseJson.saml_response;\n      } else {\n        if (!responseJson.id_token) {\n          throw new InvalidSubjectTokenError(\"Executable response must contain a 'id_token' field when \" + \"token_type=\".concat(OIDC_SUBJECT_TOKEN_TYPE1, \" or \").concat(OIDC_SUBJECT_TOKEN_TYPE2, \".\"));\n        }\n        this.subjectToken = responseJson.id_token;\n      }\n    } else {\n      // Both code and message must be provided for unsuccessful responses.\n      if (!responseJson.code) {\n        throw new InvalidCodeFieldError(\"Executable response must contain a 'code' field when unsuccessful.\");\n      }\n      if (!responseJson.message) {\n        throw new InvalidMessageFieldError(\"Executable response must contain a 'message' field when unsuccessful.\");\n      }\n      this.errorCode = responseJson.code;\n      this.errorMessage = responseJson.message;\n    }\n  }\n  /**\n   * @return A boolean representing if the response has a valid token. Returns\n   * true when the response was successful and the token is not expired.\n   */\n  _createClass(ExecutableResponse, [{\n    key: \"isValid\",\n    value: function isValid() {\n      return !this.isExpired() && this.success;\n    }\n    /**\n     * @return A boolean representing if the response is expired. Returns true if the\n     * provided timeout has passed.\n     */\n  }, {\n    key: \"isExpired\",\n    value: function isExpired() {\n      return this.expirationTime !== undefined && this.expirationTime < Math.round(Date.now() / 1000);\n    }\n  }]);\n  return ExecutableResponse;\n}();\nexports.ExecutableResponse = ExecutableResponse;\n/**\n * An error thrown by the ExecutableResponse class.\n */\nvar ExecutableResponseError = /*#__PURE__*/function (_Error) {\n  _inherits(ExecutableResponseError, _Error);\n  function ExecutableResponseError(message) {\n    var _this;\n    _classCallCheck(this, ExecutableResponseError);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ExecutableResponseError).call(this, message));\n    Object.setPrototypeOf(_assertThisInitialized(_assertThisInitialized(_this)), (this instanceof ExecutableResponseError ? this.constructor : void 0).prototype);\n    return _this;\n  }\n  return ExecutableResponseError;\n}(_wrapNativeSuper(Error));\nexports.ExecutableResponseError = ExecutableResponseError;\n/**\n * An error thrown when the 'version' field in an executable response is missing or invalid.\n */\nvar InvalidVersionFieldError = /*#__PURE__*/function (_ExecutableResponseEr) {\n  _inherits(InvalidVersionFieldError, _ExecutableResponseEr);\n  function InvalidVersionFieldError() {\n    _classCallCheck(this, InvalidVersionFieldError);\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvalidVersionFieldError).apply(this, arguments));\n  }\n  return InvalidVersionFieldError;\n}(ExecutableResponseError);\nexports.InvalidVersionFieldError = InvalidVersionFieldError;\n/**\n * An error thrown when the 'success' field in an executable response is missing or invalid.\n */\nvar InvalidSuccessFieldError = /*#__PURE__*/function (_ExecutableResponseEr2) {\n  _inherits(InvalidSuccessFieldError, _ExecutableResponseEr2);\n  function InvalidSuccessFieldError() {\n    _classCallCheck(this, InvalidSuccessFieldError);\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvalidSuccessFieldError).apply(this, arguments));\n  }\n  return InvalidSuccessFieldError;\n}(ExecutableResponseError);\nexports.InvalidSuccessFieldError = InvalidSuccessFieldError;\n/**\n * An error thrown when the 'expiration_time' field in an executable response is missing or invalid.\n */\nvar InvalidExpirationTimeFieldError = /*#__PURE__*/function (_ExecutableResponseEr3) {\n  _inherits(InvalidExpirationTimeFieldError, _ExecutableResponseEr3);\n  function InvalidExpirationTimeFieldError() {\n    _classCallCheck(this, InvalidExpirationTimeFieldError);\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvalidExpirationTimeFieldError).apply(this, arguments));\n  }\n  return InvalidExpirationTimeFieldError;\n}(ExecutableResponseError);\nexports.InvalidExpirationTimeFieldError = InvalidExpirationTimeFieldError;\n/**\n * An error thrown when the 'token_type' field in an executable response is missing or invalid.\n */\nvar InvalidTokenTypeFieldError = /*#__PURE__*/function (_ExecutableResponseEr4) {\n  _inherits(InvalidTokenTypeFieldError, _ExecutableResponseEr4);\n  function InvalidTokenTypeFieldError() {\n    _classCallCheck(this, InvalidTokenTypeFieldError);\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvalidTokenTypeFieldError).apply(this, arguments));\n  }\n  return InvalidTokenTypeFieldError;\n}(ExecutableResponseError);\nexports.InvalidTokenTypeFieldError = InvalidTokenTypeFieldError;\n/**\n * An error thrown when the 'code' field in an executable response is missing or invalid.\n */\nvar InvalidCodeFieldError = /*#__PURE__*/function (_ExecutableResponseEr5) {\n  _inherits(InvalidCodeFieldError, _ExecutableResponseEr5);\n  function InvalidCodeFieldError() {\n    _classCallCheck(this, InvalidCodeFieldError);\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvalidCodeFieldError).apply(this, arguments));\n  }\n  return InvalidCodeFieldError;\n}(ExecutableResponseError);\nexports.InvalidCodeFieldError = InvalidCodeFieldError;\n/**\n * An error thrown when the 'message' field in an executable response is missing or invalid.\n */\nvar InvalidMessageFieldError = /*#__PURE__*/function (_ExecutableResponseEr6) {\n  _inherits(InvalidMessageFieldError, _ExecutableResponseEr6);\n  function InvalidMessageFieldError() {\n    _classCallCheck(this, InvalidMessageFieldError);\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvalidMessageFieldError).apply(this, arguments));\n  }\n  return InvalidMessageFieldError;\n}(ExecutableResponseError);\nexports.InvalidMessageFieldError = InvalidMessageFieldError;\n/**\n * An error thrown when the subject token in an executable response is missing or invalid.\n */\nvar InvalidSubjectTokenError = /*#__PURE__*/function (_ExecutableResponseEr7) {\n  _inherits(InvalidSubjectTokenError, _ExecutableResponseEr7);\n  function InvalidSubjectTokenError() {\n    _classCallCheck(this, InvalidSubjectTokenError);\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvalidSubjectTokenError).apply(this, arguments));\n  }\n  return InvalidSubjectTokenError;\n}(ExecutableResponseError);\nexports.InvalidSubjectTokenError = InvalidSubjectTokenError;","map":null,"metadata":{},"sourceType":"script"}